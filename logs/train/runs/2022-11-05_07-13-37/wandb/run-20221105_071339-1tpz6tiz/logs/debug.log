2022-11-05 07:13:39,235 INFO    MainThread:52117 [wandb_setup.py:_flush():68] Configure stats pid to 52117
2022-11-05 07:13:39,235 INFO    MainThread:52117 [wandb_setup.py:_flush():68] Loading settings from /root/.config/wandb/settings
2022-11-05 07:13:39,235 INFO    MainThread:52117 [wandb_setup.py:_flush():68] Loading settings from /home/ubuntu/yisakk/Template/template_pl-hydra/wandb/settings
2022-11-05 07:13:39,235 INFO    MainThread:52117 [wandb_setup.py:_flush():68] Loading settings from environment variables: {'_require_service': 'True'}
2022-11-05 07:13:39,235 INFO    MainThread:52117 [wandb_setup.py:_flush():68] Inferring run settings from compute environment: {'program_relpath': 'src/train.py', 'program': 'src/train.py'}
2022-11-05 07:13:39,235 INFO    MainThread:52117 [wandb_init.py:_log_setup():476] Logging user logs to /home/ubuntu/yisakk/Template/template_pl-hydra/logs/train/runs/2022-11-05_07-13-37/wandb/run-20221105_071339-1tpz6tiz/logs/debug.log
2022-11-05 07:13:39,236 INFO    MainThread:52117 [wandb_init.py:_log_setup():477] Logging internal logs to /home/ubuntu/yisakk/Template/template_pl-hydra/logs/train/runs/2022-11-05_07-13-37/wandb/run-20221105_071339-1tpz6tiz/logs/debug-internal.log
2022-11-05 07:13:39,236 INFO    MainThread:52117 [wandb_init.py:init():516] calling init triggers
2022-11-05 07:13:39,236 INFO    MainThread:52117 [wandb_init.py:init():519] wandb.init called with sweep_config: {}
config: {}
2022-11-05 07:13:39,236 INFO    MainThread:52117 [wandb_init.py:init():569] starting backend
2022-11-05 07:13:39,236 INFO    MainThread:52117 [wandb_init.py:init():573] setting up manager
2022-11-05 07:13:39,238 INFO    MainThread:52117 [backend.py:_multiprocessing_setup():102] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2022-11-05 07:13:39,240 INFO    MainThread:52117 [wandb_init.py:init():580] backend started and connected
2022-11-05 07:13:39,243 INFO    MainThread:52117 [wandb_init.py:init():658] updated telemetry
2022-11-05 07:13:39,255 INFO    MainThread:52117 [wandb_init.py:init():693] communicating run to backend with 60 second timeout
2022-11-05 07:13:39,995 INFO    MainThread:52117 [wandb_run.py:_on_init():2000] communicating current version
2022-11-05 07:13:40,068 INFO    MainThread:52117 [wandb_run.py:_on_init():2004] got version response 
2022-11-05 07:13:40,068 INFO    MainThread:52117 [wandb_init.py:init():728] starting run threads in backend
2022-11-05 07:13:40,210 INFO    MainThread:52117 [wandb_run.py:_console_start():1980] atexit reg
2022-11-05 07:13:40,210 INFO    MainThread:52117 [wandb_run.py:_redirect():1838] redirect: SettingsConsole.WRAP_RAW
2022-11-05 07:13:40,210 INFO    MainThread:52117 [wandb_run.py:_redirect():1903] Wrapping output streams.
2022-11-05 07:13:40,211 INFO    MainThread:52117 [wandb_run.py:_redirect():1925] Redirects installed.
2022-11-05 07:13:40,211 INFO    MainThread:52117 [wandb_init.py:init():765] run started, returning control to user process
2022-11-05 07:13:40,381 INFO    MainThread:52117 [wandb_run.py:_config_callback():1160] config_cb None None {'model/_target_': 'src.models.mnist_module.MNISTLitModule', 'model/optimizer/_target_': 'torch.optim.Adam', 'model/optimizer/_partial_': True, 'model/optimizer/lr': 0.001, 'model/optimizer/weight_decay': 0.0, 'model/scheduler/_target_': 'torch.optim.lr_scheduler.ReduceLROnPlateau', 'model/scheduler/_partial_': True, 'model/scheduler/mode': 'min', 'model/scheduler/factor': 0.1, 'model/scheduler/patience': 10, 'model/net/_target_': 'src.models.components.simple_dense_net.SimpleDenseNet', 'model/net/input_size': 784, 'model/net/lin1_size': 64, 'model/net/lin2_size': 128, 'model/net/lin3_size': 64, 'model/net/output_size': 10, 'model/params/total': 67978, 'model/params/trainable': 67978, 'model/params/non_trainable': 0, 'datamodule/_target_': 'src.datamodules.mnist_datamodule.MNISTDataModule', 'datamodule/data_dir': '/home/ubuntu/yisakk/Template/template_pl-hydra/data/', 'datamodule/batch_size': 128, 'datamodule/train_val_test_split': [55000, 5000, 10000], 'datamodule/num_workers': 0, 'datamodule/pin_memory': False, 'trainer/_target_': 'pytorch_lightning.Trainer', 'trainer/default_root_dir': '/home/ubuntu/yisakk/Template/template_pl-hydra/logs/train/runs/2022-11-05_07-13-37', 'trainer/min_epochs': 1, 'trainer/max_epochs': 10, 'trainer/accelerator': 'cpu', 'trainer/devices': 1, 'trainer/check_val_every_n_epoch': 1, 'trainer/deterministic': False, 'callbacks/model_checkpoint/_target_': 'pytorch_lightning.callbacks.ModelCheckpoint', 'callbacks/model_checkpoint/dirpath': '/home/ubuntu/yisakk/Template/template_pl-hydra/logs/train/runs/2022-11-05_07-13-37/checkpoints', 'callbacks/model_checkpoint/filename': 'epoch_{epoch:03d}', 'callbacks/model_checkpoint/monitor': 'val/acc', 'callbacks/model_checkpoint/verbose': False, 'callbacks/model_checkpoint/save_last': True, 'callbacks/model_checkpoint/save_top_k': 1, 'callbacks/model_checkpoint/mode': 'max', 'callbacks/model_checkpoint/auto_insert_metric_name': False, 'callbacks/model_checkpoint/save_weights_only': False, 'callbacks/model_checkpoint/every_n_train_steps': 'None', 'callbacks/model_checkpoint/train_time_interval': 'None', 'callbacks/model_checkpoint/every_n_epochs': 'None', 'callbacks/model_checkpoint/save_on_train_epoch_end': 'None', 'callbacks/early_stopping/_target_': 'pytorch_lightning.callbacks.EarlyStopping', 'callbacks/early_stopping/monitor': 'val/acc', 'callbacks/early_stopping/min_delta': 0.0, 'callbacks/early_stopping/patience': 100, 'callbacks/early_stopping/verbose': False, 'callbacks/early_stopping/mode': 'max', 'callbacks/early_stopping/strict': True, 'callbacks/early_stopping/check_finite': True, 'callbacks/early_stopping/stopping_threshold': 'None', 'callbacks/early_stopping/divergence_threshold': 'None', 'callbacks/early_stopping/check_on_train_epoch_end': 'None', 'callbacks/model_summary/_target_': 'pytorch_lightning.callbacks.RichModelSummary', 'callbacks/model_summary/max_depth': -1, 'callbacks/rich_progress_bar/_target_': 'pytorch_lightning.callbacks.RichProgressBar', 'extras/ignore_warnings': False, 'extras/enforce_tags': True, 'extras/print_config': True, 'task_name': 'train', 'tags': ['dev'], 'ckpt_path': 'None', 'seed': 'None'}
2022-11-05 07:17:20,612 INFO    MainThread:52117 [wandb_run.py:_finish():1746] finishing run yisakk/pl-hydra_test/1tpz6tiz
2022-11-05 07:17:20,612 INFO    MainThread:52117 [wandb_run.py:_atexit_cleanup():1949] got exitcode: 0
2022-11-05 07:17:20,613 INFO    MainThread:52117 [wandb_run.py:_restore():1932] restore
2022-11-05 07:17:20,613 INFO    MainThread:52117 [wandb_run.py:_restore():1938] restore done
2022-11-05 07:17:28,350 INFO    MainThread:52117 [wandb_run.py:_footer_history_summary_info():3377] rendering history
2022-11-05 07:17:28,351 INFO    MainThread:52117 [wandb_run.py:_footer_history_summary_info():3409] rendering summary
2022-11-05 07:17:28,354 INFO    MainThread:52117 [wandb_run.py:_footer_sync_info():3333] logging synced files
